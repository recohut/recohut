<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<link rel="alternate" type="application/rss+xml" href="/ai/blog/rss.xml" title="AI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ai/blog/atom.xml" title="AI Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">Blog | AI</title><meta data-rh="true" property="og:title" content="Blog | AI"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" property="og:url" content="https://docs.recohut.com/ai/blog/page/2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/ai/img/logo.svg"><link data-rh="true" rel="canonical" href="https://docs.recohut.com/ai/blog/page/2"><link data-rh="true" rel="alternate" href="https://docs.recohut.com/ai/blog/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.recohut.com/ai/blog/page/2" hreflang="x-default"><link rel="stylesheet" href="/ai/assets/css/styles.fbf22338.css">
<link rel="preload" href="/ai/assets/js/runtime~main.ad24f9b7.js" as="script">
<link rel="preload" href="/ai/assets/js/main.f665fcd1.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ai/"><div class="navbar__logo"><img src="/ai/img/logo.svg" alt="Recohut Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/ai/img/logo.svg" alt="Recohut Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Recohut</b></a><a class="navbar__item navbar__link" href="/ai/docs/intro">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ai/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/sparsh-ai/ai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/ai/blog/2021/10/01/clinical-decision-making">Clinical Decision Making</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/ai/blog/2021/10/01/detectron-2">Detectron 2</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/ai/blog/2021/10/01/distributed-training-of-recommender-systems">Distributed Training of Recommender Systems</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/ai/blog/2021/10/01/document-recommendation">Document Recommendation</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/ai/blog/2021/10/01/fake-voice-detection">Fake Voice Detection</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/object-detection-with-yolo3">Object detection with YOLO3</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_mojV" id="live-app">Live app<a class="hash-link" href="#live-app" title="Direct link to heading">​</a></h2><p>This app can detect COCO 80-classes using three different models - Caffe MobileNet SSD, Yolo3-tiny, and Yolo3. It can also detect faces using two different models - SSD Res10 and OpenCV face detector.  Yolo3-tiny can also detect fires.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-object-detection-with-yolo3-untitled.png" src="/ai/assets/images/content-blog-raw-blog-object-detection-with-yolo3-untitled-7c24204b83a8bd10c57c53b4b2423899.png" width="1366" height="645"></p><p><img loading="lazy" alt="/img/content-blog-raw-blog-object-detection-with-yolo3-untitled-1.png" src="/ai/assets/images/content-blog-raw-blog-object-detection-with-yolo3-untitled-1-c0c4b05a1cf3256f1a9d0ebdb5f4bfb5.png" width="1366" height="640"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="code">Code<a class="hash-link" href="#code" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> streamlit </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> st</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cv2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> PIL </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tempfile </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> NamedTemporaryFile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> tensorflow</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">preprocessing</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> img_to_array</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> load_img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">temp_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> NamedTemporaryFile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">delete</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">False</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEFAULT_CONFIDENCE_THRESHOLD </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DEMO_IMAGE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;test_images/demo.jpg&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MODEL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;model/MobileNetSSD_deploy.caffemodel&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PROTOTXT </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;model/MobileNetSSD_deploy.prototxt.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLASSES </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;background&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;aeroplane&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;bicycle&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;bird&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;boat&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;bottle&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;bus&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;car&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;cat&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;chair&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;cow&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;diningtable&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;dog&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;horse&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;motorbike&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;person&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;pottedplant&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;sheep&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;sofa&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;train&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;tvmonitor&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COLORS </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">random</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">uniform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> size</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CLASSES</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@st</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">process_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    blob </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dnn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blobFromImage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.007843</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">300</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    net </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dnn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">readNetFromCaffe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">PROTOTXT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MODEL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">setInput</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">blob</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    detections </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> net</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> detections</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@st</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">annotate_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detections</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> confidence_threshold</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">DEFAULT_CONFIDENCE_THRESHOLD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># loop over the detections</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">h</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        confidence </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> detections</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> confidence </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> confidence_threshold</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># extract the index of the class label from the `detections`,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># then compute the (x, y)-coordinates of the bounding box for</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># the object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            idx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">detections</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            box </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> detections</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> w</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> h</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">startX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> startY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> endX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> endY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> box</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;int&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># display the prediction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            label </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">CLASSES</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation">idx</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">round</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">confidence </span><span class="token string-interpolation interpolation operator" style="color:#393A34">*</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">100</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">,</span><span class="token string-interpolation interpolation"> </span><span class="token string-interpolation interpolation number" style="color:#36acaa">2</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">%&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            labels</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">label</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rectangle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">startX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> startY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">endX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> endY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> COLORS</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> startY </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> startY </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> startY </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">putText</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">startX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">FONT_HERSHEY_SIMPLEX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> COLORS</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">idx</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  selected_box </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sidebar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">selectbox</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&#x27;Choose one of the following&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Welcome&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Object Detection&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> selected_box </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Welcome&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      welcome</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> selected_box </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Object Detection&#x27;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      object_detection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">welcome</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Object Detection using Streamlit&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">subheader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;A simple app for object detection&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;test_images/demo.jpg&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">use_column_width</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">object_detection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Object detection with MobileNet SSD&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  confidence_threshold </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sidebar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">slider</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;Confidence threshold&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DEFAULT_CONFIDENCE_THRESHOLD</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.05</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sidebar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">multiselect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Select object classes to include&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  options</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">CLASSES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  default</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">CLASSES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  img_file_buffer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">file_uploader</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Upload an image&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">type</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;png&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jpg&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;jpeg&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> img_file_buffer </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      temp_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">img_file_buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getvalue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> load_img</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">temp_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> img_to_array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> image</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">255.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      demo_image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> DEMO_IMAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">demo_image</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  detections </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> process_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> labels </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> annotate_image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detections</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> confidence_threshold</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> caption</span><span class="token operator" style="color:#393A34">=</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Processed image&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_column_width</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  st</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">write</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">labels</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><em>You can play with the live app</em> <a href="https://share.streamlit.io/sparsh-ai/streamlit-489fbbb7/app.py" target="_blank" rel="noopener noreferrer">*here</a>. Source code is available <a href="https://github.com/sparsh-ai/streamlit-5a407279/tree/master" target="_blank" rel="noopener noreferrer">here</a> on Github.*</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/app">app</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/streamlit">streamlit</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/vision">vision</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/ocr-experiments">OCR experiments</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-ocr-experiments-untitled.png" src="/ai/assets/images/content-blog-raw-blog-ocr-experiments-untitled-7efe4530732678d915b7176ba9205352.png" width="602" height="360"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="1-tesseract">1. Tesseract<a class="hash-link" href="#1-tesseract" title="Direct link to heading">​</a></h2><p>Tesseract is an open-source text recognition engine that is available under the Apache 2.0 license and its development has been sponsored by Google since 2006.</p><p><a href="https://nbviewer.jupyter.org/gist/sparsh-ai/2d1f533048a3655de625298c3dd32d47" target="_blank" rel="noopener noreferrer">Notebook on nbviewer</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="2-easyocr">2. EasyOCR<a class="hash-link" href="#2-easyocr" title="Direct link to heading">​</a></h2><p>Ready-to-use OCR with 70+ languages supported including Chinese, Japanese, Korean and Thai. EasyOCR is built with Python and Pytorch deep learning library, having a GPU could speed up the whole process of detection. The detection part is using the CRAFT algorithm and the Recognition model is CRNN. It is composed of 3 main components, feature extraction (we are currently using Resnet), sequence labelling (LSTM) and decoding (CTC). EasyOCR doesn’t have much software dependencies, it can directly be used with its API.</p><p><a href="https://nbviewer.jupyter.org/gist/sparsh-ai/12359606ee4127513c66fc3b4ff18e5b" target="_blank" rel="noopener noreferrer">Notebook on nbviewer</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="3-kerasocr">3. KerasOCR<a class="hash-link" href="#3-kerasocr" title="Direct link to heading">​</a></h2><p>This is a slightly polished and packaged version of the Keras CRNN implementation and the published CRAFT text detection model. It provides a high-level API for training a text detection and OCR pipeline and out-of-the-box OCR models, and an end-to-end training pipeline to build new OCR models.</p><p><a href="https://nbviewer.jupyter.org/gist/sparsh-ai/2fcb764619baf5f56cf7122b1b2c527c" target="_blank" rel="noopener noreferrer">Notebook on nbviewer</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="4-arabicocr">4. ArabicOCR<a class="hash-link" href="#4-arabicocr" title="Direct link to heading">​</a></h2><p>It is an OCR system for the Arabic language that converts images of typed text to machine-encoded text. It currently supports only letters (29 letters).  ArabicOCR aims to solve a simpler problem of OCR with images that contain only Arabic characters (check the dataset link below to see a sample of the images).</p><p><a href="https://nbviewer.jupyter.org/gist/sparsh-ai/26df76b78f8cd2018a068b284b7cfe56" target="_blank" rel="noopener noreferrer">Notebook on nbviewer</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/ocr">ocr</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/vision">vision</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/pdf-to-wordcloud-via-mail">PDF to Wordcloud via Mail</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-pdf-to-wordcloud-via-mail-untitled.png" src="/ai/assets/images/content-blog-raw-blog-pdf-to-wordcloud-via-mail-untitled-6d6e64af376a8a5c01c0ed9f1cbe7b35.png" width="766" height="525"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="objective">Objective<a class="hash-link" href="#objective" title="Direct link to heading">​</a></h2><p>Integrating PDF, Text, Wordcloud and Email functionalities in Python</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="process-flow">Process Flow<a class="hash-link" href="#process-flow" title="Direct link to heading">​</a></h2><ul><li>Step 1 - I use PyPDF2 library to read PDF text in Python</li><li>Step 2 - Import the supporting libraries</li><li>Step 3 - Count No. of Pages for this pdf and extract text for each page using loop</li><li>Step 4 - Build Text corpus by simply attaching text of next page to all the previous ones</li><li>Step 5 - Creating word frequency dataframe by first splitting text into words and counting the frequency of each word</li><li>Step 6.1 - Pre-process text i.e. removing stopwords (using nltk library), grouping common words.</li><li>Step 6.2 - used regex to extract alphabets only, lower all chracters, and sorting as per decreasing order of frequency.</li><li>Step 7 - Creating Wordcloud using matplotlib and wordcloud libraries</li><li>Step 8 - Importing required libraries like smtplib, MIME, win32 for sending the mail</li><li>Step 9 - Create outlook mail object with supporting data like filepath attachment, recepient address, mail body etc.</li><li>Step 10 - Sending the mail with required wordcloud image file attached and checking if mail is received or not!</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="code">Code<a class="hash-link" href="#code" title="Direct link to heading">​</a></h2><p><a href="https://nbviewer.jupyter.org/gist/sparsh-ai/f1de48fd4fac199bcc95e1d136fbdfd0" target="_blank" rel="noopener noreferrer">Notebook on nbviewer</a></p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/personalized-unexpectedness-in-recommender-systems">Personalized Unexpectedness in  Recommender Systems</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Classical recommender systems typically provides familier items, which not only bores customer after some time, but create a critical bias problem also, generally known as <em>filter bubble</em> or <em>echo chamber problem</em>. </p><p>To address this issue, instead of recommending best matching product all the time, we intentionally recommend a random product. For example, if a user subscribed to Netflix one month ago and watching action movies all the time. If we recommend another action movie, there is a high probability that user will click but keeping in mind the long-term user satisfaction and to address the filter bubble bias, we would recommend a comedy movie. Surprisingly, this strategy works!!</p><p>The most common metric is <strong><em>diversity</em></strong> factor but diversity only measures dispersion among recommended items. The better alternative is <strong><em>unexpectedness</em></strong> factor. It measures deviations of recommended items from user expectations and thus captures the concept of user surprise and allows recommender systems to break from the filter bubble. The goal is to provide novel, surprising and satisfying recommendations. </p><p>Including session-based information into the design of an unexpected recommender system is beneficial. For example, it is more reasonable to recommend the next episode of a TV series to the user who has just finished the first episode, instead of recommending new types of videos to that person. On the other hand, if the user has been binge-watching the same TV series in one night, it is better to recommend something different to him or her.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="model">Model<a class="hash-link" href="#model" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="/img/content-blog-raw-blog-personalized-unexpectedness-in-recommender-systems-untitled.png" src="/ai/assets/images/content-blog-raw-blog-personalized-unexpectedness-in-recommender-systems-untitled-22ce831b716e0985a764afbaf921c052.png" width="1130" height="412"></p><p><em>Overview of the proposed PURS model. The base model estimates the click-through rate of certain user-item pairs, while the unexpected model captures the unexpectedness of the new recommendation as well as user perception towards unexpectedness.</em></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="offline-experiment-results">Offline Experiment Results<a class="hash-link" href="#offline-experiment-results" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="/img/content-blog-raw-blog-personalized-unexpectedness-in-recommender-systems-untitled-1.png" src="/ai/assets/images/content-blog-raw-blog-personalized-unexpectedness-in-recommender-systems-untitled-1-a53c9776871c615a07a1ed66b415a0b0.png" width="1213" height="283"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="online-ab-test-results">Online A/B Test Results<a class="hash-link" href="#online-ab-test-results" title="Direct link to heading">​</a></h3><p>Authors conducted the online A/B test at Alibaba-Youku, a major video recommendation platform from 2019-11 to 2019-12. During the testing period, they compared the proposed PURS model with the latest production model in the company. They measured the performance using standard business metrics: <strong>VV</strong> (Video View, average video viewed by each user), <strong>TS</strong> (Time Spent, average time that each user spends on the platform), <strong>ID</strong> (Impression Depth, average impression through one session) and <strong>CTR</strong> (Click-Through-Rate, the percentage of user clicking on the recommended video). They also measure the novelty of the recommended videos using the unexpectedness and coverage measures.</p><p><img loading="lazy" alt="Represents statistical significance at the 0.95 level." src="/ai/assets/images/content-blog-raw-blog-personalized-unexpectedness-in-recommender-systems-untitled-2-f913dc7e387c8c255ac6d22c86606a7d.png" width="792" height="66"></p><p>Represents statistical significance at the 0.95 level.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="code-walkthrough">Code Walkthrough<a class="hash-link" href="#code-walkthrough" title="Direct link to heading">​</a></h3><blockquote><p>Note: PURS is <em>implemented in Tensorflow 1.x</em></p></blockquote><p><strong>Unexpected attention (<a href="https://github.com/lpworld/PURS/blob/master/model.py" target="_blank" rel="noopener noreferrer">model.py</a>)</strong></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unexp_attention</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> querys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys_id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Same Attention as in the DIN model</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        queries:     [Batchsize, 1, embedding_size]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        keys:        [Batchsize, max_seq_len, embedding_size]  max_seq_len is the number of keys(e.g. number of clicked creativeid for each sample)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        keys_id:     [Batchsize, max_seq_len]</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        querys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">expand_dims</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">querys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keys_length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># padded_dim</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        embedding_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> querys</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_shape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">as_list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        keys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys_length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> embedding_size</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        querys </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">querys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys_length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys_length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> embedding_size</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        net </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> querys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> querys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">querys</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> units </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            net </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> units</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">units</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">relu</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        att_wgt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dense</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">net</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> units</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> activation</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sigmoid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># shape(batch_size, max_seq_len, 1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">att_wgt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> shape</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys_length</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;weight&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">#shape(batch_size, 1, max_seq_len)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> outputs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scores </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">embedding_size </span><span class="token operator" style="color:#393A34">**</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic"># scale</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scores </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scores</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">matmul</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">scores</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">#(batch_size, 1, embedding_size)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        outputs </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">reduce_sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outputs</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;unexp_embedding&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">#(batch_size, embedding_size)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> outputs</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><strong>Unexpected metric calculation (<a href="https://github.com/lpworld/PURS/blob/master/train.py" target="_blank" rel="noopener noreferrer">train.py</a>)</strong></p><div class="codeBlockContainer_I0IT language-python theme-code-block"><div class="codeBlockContent_wNvx python"><pre tabindex="0" class="prism-code language-python codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">unexpectedness</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sess</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_set</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    unexp_list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uij </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> DataInput</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test_set</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> item</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unexp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sess</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uij</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> index </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unexp_list</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexp</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unexp_list</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h3><ol><li><a href="https://arxiv.org/pdf/2106.02771v1.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2106.02771v1.pdf</a></li><li><a href="https://github.com/lpworld/PURS" target="_blank" rel="noopener noreferrer">https://github.com/lpworld/PURS</a></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/personalization">personalization</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/predicting-electronics-resale-price">Predicting Electronics Resale Price</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-predicting-electronics-resale-price-untitled.png" src="/ai/assets/images/content-blog-raw-blog-predicting-electronics-resale-price-untitled-3fed3bed15da063ddd1654593580a934.png" width="592" height="146"></p><h1>Objective</h1><p>Predict the resale price based on brand, part id and purchase quantity</p><h1>Milestones</h1><ul><li>Data analysis and discovery - What is the acceptable variance the model needs to meet in terms of similar part number and quantity?</li><li>Model research and validation - Does the model meet the variance requirement? (Variance of the model should meet or be below the variance of the sales history)</li><li>Model deployment - Traffic will increase 10 fold. So, model needs to be containerized or dockerized</li><li>Training - Model needs to be trainable on new sales data. Methodology to accept or reject the variance of the newly trained model documented.</li></ul><h1>Deliverables</h1><ol><li><p>Data Analysis and Discovery (identify target variance for pricing model in terms of similar part numbers and quantities). Analysis should be done on the 12 following quantity ranges: 1-4, 5-9, 10-24, 25-49, 50-99, 100-249, 250-499, 500-999, 1000-2499, 2500-4999, 5000-9999, 10000+.</p></li><li><p>ModelA Training (Resale Value Estimation <!-- -->[$]<!-- --> (Brand+PartNo.+Quantity)</p></li><li><p>ModelA Validation (variance analysis and comparison with sales history variance in terms of similar part numbers and quantities)</p></li><li><p>ModelA Containerization</p></li><li><p>ModelA re-training based on new sales data</p></li><li><p>ScriptA to calculate variance for new sales data (feedback for training results)</p></li><li><p>Documentation for re-training</p></li><li><p>ModelA deployment and API</p></li></ol><h1>Modeling Approach</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="framework">Framework<a class="hash-link" href="#framework" title="Direct link to heading">​</a></h3><ul><li>Fully connected regression neural network</li><li>NLP feature extraction from part id</li><li>Batch generator to feed large data in batches</li><li>Hyperparameter tuning to find the best model fit</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="list-of-variables">List of Variables<a class="hash-link" href="#list-of-variables" title="Direct link to heading">​</a></h3><ul><li>2 years of sales history</li><li>PRC</li><li>PARTNO</li><li>ORDER_NUMBER</li><li>ORIG_ORDER_QTY</li><li>UNIT_COST</li><li>UNIT_REASLE</li><li>UOM (UNIT OF MEASUREMENT)</li></ul><h1>Bucket of Ideas</h1><ol><li>Increase n-gram range; e.g. in part_id ABC-123-23, these are 4-grams: ABC-, BC-1, C-12, -123, 123-, 23-2, 3-23; Idea is to see if increasing this range further will increase the model&#x27;s performance</li><li>Employ Char-level LSTM to capture sequence information; e.g. in same part_id ABC-123-23, currently we are not maintaining sequence of grams, we don&#x27;t know if 3-23 is coming at first or last; here, the idea is to see if lstm model can be employed to capture this sequence information to improve model&#x27;s performance</li><li>New Loss function - including cost based loss</li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/regression">regression</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/real-time-news-personalization-with-flink">Real-time news personalization with Flink</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->10 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_mojV" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">​</a></h2><p>News recommendation system has a high degree of real-time because there will be a large number of news and hot spots at any time. Incremental updating, online learning, local updating and even reinforcement learning can make the recommender system quickly respond to the user‘s new behavior, and the premise of these updating strategies is that the sample itself has enough real-time information. In news recommendation system, the typical training sample is the user’s click behavior data.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="why-is-the-real-time-nature-of-the-recommendation-system-important">Why is the real-time nature of the recommendation system important?<a class="hash-link" href="#why-is-the-real-time-nature-of-the-recommendation-system-important" title="Direct link to heading">​</a></h3><p>Intuitively, when users use personalized news applications, users expect to find articles that match their interests faster; when using short video services, they expect to &quot;flash&quot; content that they are interested in faster; when doing online shopping, I also hope to find the products that I like, faster. All recommendations highlight the word &quot;fast&quot;, which is an intuitive manifestation of the &quot;real-time&quot; role of the recommendation system.</p><p>From a professional point of view, the real-time performance of the recommendation system is also crucial, which is mainly reflected in the following two aspects:</p><ol><li><strong>The faster the update speed of the recommendation system is, the more it can reflect the user&#x27;s recent user habits, and the more time-sensitive it can make recommendations to the user.</strong></li><li><strong>The faster the recommendation system is updated, the easier it is for the model to find the latest popular data patterns, and the more it can make the model react to find the latest fashion trends.</strong></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-real-time-nature-of-the-feature-of-the-recommendation-system">The real-time nature of the &quot;feature&quot; of the recommendation system<a class="hash-link" href="#the-real-time-nature-of-the-feature-of-the-recommendation-system" title="Direct link to heading">​</a></h3><p>Suppose a user has watched a 10-minute &quot;badminton teaching&quot; video in its entirety. Then there is no doubt that the user is interested in the subject of &quot;badminton&quot;. The system hopes to continue to recommend &quot;badminton&quot; related videos when the user turns the page next time. However, due to the lack of real-time features of the system, the user’s viewing history cannot be fed back to the recommendation system in real time. As a result, the recommendation system learned that the user had watched the video &quot;Badminton Teaching&quot;. It was already half an hour later. Has left the app. This is an example of recommendation failure caused by poor real-time performance of the recommendation system.</p><p>It is true that the next time the user opens the application, the recommendation system can use the last user behavior history to recommend &quot;badminton&quot; related videos, but the recommendation system undoubtedly loses what is most likely to increase user viscosity and increase user retention. opportunity.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="the-real-time-nature-of-the-model-of-the-recommender-system">The real-time nature of the &quot;model&quot; of the recommender system<a class="hash-link" href="#the-real-time-nature-of-the-model-of-the-recommender-system" title="Direct link to heading">​</a></h3><p>No matter how strong the real-time feature is, the scope of influence is limited to the current user. Compared with the real-time nature of &quot;features&quot;, the real-time nature of the recommendation system model is often considered from a more global perspective . The real-time nature of the feature attempts to describe a person with more accurate features, so that the recommendation system can give a recommendation result that is more in line with the person. The real-time nature of the model hopes to capture new data patterns at the global level faster and discover new trends and relevance.</p><p>Take, for example, a large number of promotional activities on Double Eleven on an e-commerce website. The real-time nature of the feature will quickly discover the products that the user may be interested in based on the user&#x27;s recent behavior, but will never find the latest preferences of similar users, the latest correlation information between the products, and the trend information of new activities.</p><p>To discover such global data changes, the model needs to be updated faster. The most important factor affecting the real-time performance of the model is the training method of the model.</p><ol><li><strong>Full update -</strong> The most common way of model training is full update. The model will use all training samples in a certain period of time for retraining, and then replace the &quot;outdated&quot; model with the new trained model. However, the full update requires a large amount of training samples, so the training time required is longer; and the full update is often performed on offline big data platforms, such as spark+tensorflow, so the data delay is also longer, which leads to the full update It is the worst &quot;real-time&quot; model update method. In fact, for a model that has been trained, it is enough to learn only the newly added incremental samples, which is called incremental update.</li><li><strong>Incremental update (Incremental Learning)</strong> - Incremental update only feeds newly added samples to the model for incremental learning . Technically, deep learning models often use stochastic gradient descent (SGD) and its variants for learning. The model&#x27;s learning of incremental samples is equivalent to continuing to input incremental samples for gradient descent on the basis of the original samples. Therefore, based on the deep learning model, it is not difficult to change from full update to incremental update. But everything in engineering is a tradeoff, there is never a perfect solution, and incremental updates are no exception. Since only incremental samples are used for learning, the model also converges to the best point of the new sample after multiple epochs, and it is difficult to converge to the global best point of all the original samples + incremental samples. Therefore, in the actual recommendation system, the incremental update and the global update are often combined . After several rounds of incremental update, the global update is performed in a time window with a small business volume, and the model is corrected after the incremental update process. Accumulated errors in. Make trade-offs and trade-offs between &quot;real-time performance&quot; and &quot;global optimization&quot;.</li><li><strong>Online learning</strong> - &quot;Online learning&quot; is a further improvement of &quot;incremental update&quot;, &quot;incremental update&quot; is to perform incremental update when a batch of new samples is obtained, and online learning is to update the model in real time every time a new sample is obtained. Online learning can also be implemented technically through SGD. But if you use the general SGD method, online learning will cause a very serious problem, that is, the sparsity of the model is very poor, opening too many &quot;fragmented&quot; unimportant features. We pay attention to the &quot;sparseness&quot; of the model in a sense that is also an engineering consideration. For example, in a model with an input vector of several million dimensions, if the sparsity of the model is good, the effect of the model can be maintained without affecting the model. , Only make the corresponding weight of the input vector of a very small part of the dimension non-zero, that is to say, when the model is online, the volume of the model is very small, which is undoubtedly beneficial to the entire model serving process. Both the memory space required to store the model and the speed of online inference will benefit from the sparsity of the model. If the SGD method is used to update the model, it is easier to generate a large number of features with small weights than the batch method, which increases the difficulty of model deployment and update. So in order to take into account the training effect and model sparsity in the online learning process, there are a lot of related researches. The most famous ones include Microsoft&#x27;s RDA, Google&#x27;s FOBOS and the most famous FTRL, etc.</li><li><strong>Partial model update</strong> - Another improvement direction to improve the real-time performance of the model is to perform a partial update of the model. The general idea is to reduce the update frequency of the part with low training efficiency and increase the update frequency of the part with high training efficiency . This approach is representative of the GBDT+LR model of Facebook.</li></ol><p><img loading="lazy" alt="/img/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled.png" src="/ai/assets/images/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled-0a226898c0c217ee517545659bc11b51.png" width="720" height="589"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="data-pipeline-of-a-typical-news-recommendation-system">Data pipeline of a typical news recommendation system<a class="hash-link" href="#data-pipeline-of-a-typical-news-recommendation-system" title="Direct link to heading">​</a></h2><p>When a user is exposed with a list of news articles, a page view events are sent to the backend server and when that user clicks on the news of interest, the action events are also sent to the backend server. After receiving these 2 event streams (page view and clicks), the backend server will send these user behaviour events to the message queue. And message queue finally stores these messages into the distributed file system, such as HDFS.</p><p>For model training, we need a training sample. The most common sampling technique is negative sampling. In this, we generate &#x27;n&#x27; negative samples for each positive event that we receive. Users will only generate behavior for some exposed news samples, which are positive samples, and the remaining exposure samples without behavior are negative samples. After generating positive and negative samples, the model can be trained.</p><p>The recommendation system with low real-time requirements can use batch processing technology (APACHE spark is a typical tool) to generate samples, as shown in the left figure. Set a timing task, and read the user behavior log and exposure log in the time window from HDFS every other period of time, such as one hour, to perform join operation, generate training samples, and then write the training samples back to HDFS, Then start the training update of the model.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled-1.png" src="/ai/assets/images/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled-1-319655da20fc7d94210cca6b2a83dbc7.png" width="732" height="307"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="problems">Problems<a class="hash-link" href="#problems" title="Direct link to heading">​</a></h3><p>One obvious problem with batch processing is <strong>latency</strong>. The typical cycle of running batch tasks regularly is one hour, which means that there is a delay of at least one hour from sample generation to model training. Sometimes, if the batch platform is overloaded and the tasks need to be queued, the delay will be greater.</p><p>Another problem is the <strong>boundary</strong> problem. If page view (PV) data is generated at the end of the log time window selected by the batch task, the corresponding action data may fall into the next time window of the batch task, resulting in join failure and false negative samples.</p><p>A related problem to this is the time synchronization problem. When a news item is exposed to the user, the user may click immediately after the PV data stream is generated, or the user may act after a few minutes, more than ten minutes, or even several hours. This means that after the PV data stream arrives, it needs to wait for a period of time to join with the action data stream. If the waiting time is too long, some samples (positive samples) that should have user behavior will be wrongly marked as negative samples because the user behavior has no time to return. Too long waiting time will damage and increase the system delay. Offline analysis of the delay distribution between the actual action data stream and PV data stream is a very typical exponential distribution.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled-2.png" src="/ai/assets/images/content-blog-raw-blog-real-time-news-personalization-with-flink-untitled-2-55b1c3ab0b3ab90bdefc3cc1a6ec7d86.png" width="732" height="485"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="apache-flink-to-the-rescue">Apache Flink to the rescue<a class="hash-link" href="#apache-flink-to-the-rescue" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="how-apache-flink-solves-the-latency-problem">How Apache Flink solves the latency problem?<a class="hash-link" href="#how-apache-flink-solves-the-latency-problem" title="Direct link to heading">​</a></h3><p>In order to enhance the real-time performance, we use Apache Flink framework to rewrite the sample generation logic with stream processing technology. As shown in the right figure above, after the user exposure and behavior logs generated by online services are written into the message queue, instead of waiting for them to drop to HDFS, we directly consume these message flows with Flink. At the same time, Flink reads the necessary feature information from the redis cache and generates the sample message stream directly. The sample message flow is written back to the Kafka queue, and downstream tensorflow can directly consume the message flow for model training.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="how-apache-flink-solved-the-boundary-and-synchronization-problem">How Apache Flink solved the boundary and synchronization problem?<a class="hash-link" href="#how-apache-flink-solved-the-boundary-and-synchronization-problem" title="Direct link to heading">​</a></h3><p>As per the exponential distribution (analyzed on a private dataset of a news recommender app), most of the user behavior has reflow within a few minutes. And if few minutes is an acceptable delay, a simple solution is to set a time window with a compromise size. Flink provides window join to implement this logic.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ol><li><a href="https://developpaper.com/flink-streaming-processing-and-real-time-sample-generation-in-recommender-system/" target="_blank" rel="noopener noreferrer">https://developpaper.com/flink-streaming-processing-and-real-time-sample-generation-in-recommender-system/</a></li><li><a href="https://zhuanlan.zhihu.com/p/74813776" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/74813776</a></li><li><a href="https://zhuanlan.zhihu.com/p/75597761" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/75597761</a></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/personalization">personalization</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/realtime">realtime</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/semantic-similarity">Semantic Similarity</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-semantic-similarity-untitled.png" src="/ai/assets/images/content-blog-raw-blog-semantic-similarity-untitled-7d572e51518b870475eaa94a0500aed6.png" width="715" height="376"></p><h1>Introduction</h1><p>Deliverable - Two paragraph-level distance outputs for L and Q, each has 35 columns. </p><p>For each paragraph, we need to calculate the L1 distance of consecutive sentences in this paragraph, and then generate the mean and standard deviation of all these distances for this paragraph. For example, say the paragraph 1 starts from sentence1 and ends with sentence 5. First, calculate the L1 distances for L1(1,2), L1(2,3), L1(3,4) and L1(4,5) and then calculate the mean and standard deviation of the 4 distances. In the end we got two measures for this paragraph: L1_m and L1_std. Similarly, we need to calculate the mean and standard deviation using L2 distance, plus a simple mean and deviation of the distances. We use 6 different embeddings: all dimensions of BERT embeddings, 100,200 and 300 dimensions of PCA Bert embeddings (PCA is a dimension reduction technique </p><p>In the end, we will have 35 columns for each paragraph : Paragraph ID +#sentences in the paragraph +(cosine_m, cosine_std,cossimillarity_m, cosimmilarity_std, L1_m, L1_std, L2_m, L2_std ) – by- ( all, 100, 200, 300)= 3+8*4. </p><p>Note: for paragraph that only has 1 sentence, the std measures are empty.</p><h1>Modeling Approach</h1><h3 class="anchor anchorWithStickyNavbar_mojV" id="process-flow-for-use-case-1">Process Flow for Use Case 1<a class="hash-link" href="#process-flow-for-use-case-1" title="Direct link to heading">​</a></h3><ol><li>Splitting paragraphs into sentences using 1) NLTK Sentence Tokenizer, 2) Spacy Sentence Tokenizer and, on two additional symbols <code>:</code> and <code>...</code></li><li>Text Preprocessing: Lowercasing, Removing Non-alphanumeric characters, Removing Null records, Removing sentence records (rows) having less than 3 words.</li><li>TF-IDF vectorization</li><li>LSA over document-term matrix</li><li>Cosine distance calculation of adjacent sentences (rows)</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="process-flow-for-use-case-2">Process Flow for Use Case 2<a class="hash-link" href="#process-flow-for-use-case-2" title="Direct link to heading">​</a></h3><ul><li>Split paragraphs into sentences</li><li>Text cleaning</li><li>BERT Sentence Encoding</li><li>BERT PCA 100</li><li>BERT PCA 200</li><li>BERT PCA 300</li><li>Calculate distance between consecutive sentences in the paragraph</li><li>Distances: L1, L2 and Cosine and Cosine similarity</li><li>Statistics: Mean, SD</li></ul><h1>Experimental Setup</h1><ol><li>#IncrementalPCA</li><li>GPU to speed up</li><li>Data chunking</li><li>Calculate BERT for a chunk and store in disk</li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/nlp">nlp</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/similarity">similarity</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/short-video-background-music-recommender">Short-video Background Music Recommender</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>Matching micro-videos with suitable background music can help uploaders better convey their contents and emotions, and increase the click-through rate of their uploaded videos. However, manually selecting the background music becomes a painstaking task due to the voluminous and ever-growing pool of candidate music. Therefore, automatically recommending background music to videos becomes an important task.</p><p>In <a href="https://arxiv.org/pdf/2107.07268.pdf" target="_blank" rel="noopener noreferrer">this</a> paper, Zhu et. al. shared their approach to solve this task. They first collected ~3,000 background music from popular TikTok videos and also ~150,000 video clips that used some kind of background music. They named this dataset <code>TT-150K</code>.</p><p><img loading="lazy" alt="An exemplar subset of videos and their matched background music in the established TT-150k dataset" src="/ai/assets/images/content-blog-raw-blog-short-video-background-music-recommender-untitled-8e4334cad8c9ec206ebdba19b1163b61.png" width="902" height="688"></p><p>An exemplar subset of videos and their matched background music in the established TT-150k dataset</p><p>After building the dataset, they worked on modeling and proposed the following architecture:</p><p><img loading="lazy" alt="Proposed CMVAE (Cross-modal Variational Auto-encoder) framework" src="/ai/assets/images/content-blog-raw-blog-short-video-background-music-recommender-untitled-1-81086e3ba53f8bc9648682e6f1b367ed.png" width="1041" height="532"></p><p>Proposed CMVAE (Cross-modal Variational Auto-encoder) framework</p><p>The goal is to represent videos (<code>users</code> in recsys terminology) and music (<code>items</code>) in a shared latent space. To achieve this, CMVAE use pre-trained models to extract features from unstructured data - <code>vggish</code> model for audio2vec, <code>resnet</code> for video2vec and <code>bert-multilingual</code> for text2vec.  Text and video vectors are then fused using product-of-expert approach. </p><p>It uses the reconstruction power of variational autoencoders to 1) reconstruct video from music latent vector and, 2) reconstruct music from video latent vector. In layman terms, we are training a neural network that will try to guess the video activity just by listening background music, and also try to guess the background music just by seeing the video activities. </p><p>The joint training objective is $\mathcal{L}<em>{(z_m,z_v)} = \beta \cdot\mathcal{L}</em>{cross<!-- -->_<!-- -->recon} - \mathcal{L}<em>{KL} + \gamma \cdot \mathcal{L}</em>{matching}$, where $\beta$ and $\gamma$ control the weight of the cross reconstruction loss and the matching loss, respectively.</p><p>After training the model, they compared the model&#x27;s performance with existing baselines and the results are as follows:</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-short-video-background-music-recommender-untitled-2.png" src="/ai/assets/images/content-blog-raw-blog-short-video-background-music-recommender-untitled-2-0002224cfc03822d344479f3766cd1ec.png" width="1240" height="450"></p><p><strong>Conclusion</strong>: I don&#x27;t make short videos myself but can easily imagine the difficulty in finding the right background music. If I have to do this task manually, I will try out 5-6 videos and select one that I like. But here, I will be assuming that my audience would also like this music. Moreover, feedback is not actionable because it will create kind of an implicit sub-conscious effect (because when I see a video, I mostly judge it at overall level and rarely notice that background music is the problem). So, this kind of recommender system will definitely help me in selecting a better background music. Excited to see this feature soon in TikTok, Youtube Shorts and other similar services.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/recsys">recsys</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/the-progression-of-analytics-in-enterprises">The progression of analytics in enterprises</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->13 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>An organization’s analytics strategy is how its <em>people, processes, tools, and data</em> work together to collect, store, and analyze data. <em>Processes</em> refers to <em>how</em> analytics are produced, consumed, and maintained. A more modern approach to analytics is intended to support greater business agility at scale. This requires faster data preparation from a wider variety of sources, rapid prototyping and analytics model building, and cross-team collaboration processes. <em>Tools</em>, or technologies, are the raw programs and applications used to prepare for and perform analyses, such as the provisioning, flow, and automation of tasks and resources. As an analytics strategy matures, the technologies used to implement it tend to move from monolithic structures to composable microservices. The last element is <em>data.</em> A modern analytics architecture supports a growing volume and variety of data sources, which may include data from data warehouses and data lakes—streaming data, relational databases, graph databases, unstructured or semi-structured data, text data, and images.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="analytics-past-present-and-future">Analytics Past, Present, and Future<a class="hash-link" href="#analytics-past-present-and-future" title="Direct link to heading">​</a></h3><table><thead><tr><th></th><th>Past</th><th>Present</th><th>Future</th></tr></thead><tbody><tr><td></td><td>This refers to an era of analytics starting in the 1990s and running through the mid-2000s. During this phase, organizations were able to consolidate mostly transactional data into a unified system, often a data warehouse, which limited end users’ ability to interact directly with the data due to technical and governance requirements.</td><td>Starting in the late 2000s, organizations were forced to rethink how they used analytics, in no small part due to the explosion of data during this time. This was the era of “Big Data” and its infamous “ V’s”: volume, velocity, and variety.4 As organizations shifted their approach during this period, they unlocked diagnostic analytics, or the capability to answer “Why did it happen?”</td><td>The Future of Analytics Is Converged. Converged analytics unifies advances in AI, streaming data, and related technologies into a seamless analytics experience for all users. This arrangement unlocks prescriptive analytics across an organization, allowing anyone to make data-driven decisions that answer important questions.</td></tr><tr><td>People</td><td>IT professionals were needed to kick off any data-based work by extracting data from a centralized, difficult-to-use source. This process could take multiple days, and the number of query requests could easy exceed the IT team’s ability to fulfill those requests—and the opportune time for new insights.If some change was needed to data collection or storage methods, it could easily take IT months to perform. The data analysis and modeling work could take nearly as long. Rank-and-file domain experts did have some access to data, through so-called self-service business intelligence (BI) features. However, due to the same speed and accessibility issues that technical professionals faced, it was often difficult for domain experts like line of business leaders to truly lead with data for decision making.</td><td>It’s no coincidence that around the same time as Big Data emerged, so did the role of the data scientist. Compared with earlier roles like researcher or statistician, the data scientist blends quantitative and domain expertise with a greater degree of computational thinking. These skills became necessary both to handle the greater variety and volume of data sources and to update and deploy data and analytics models without the assistance of IT professionals.Whereas IT in the past sought to meticulously catalog and structure data to enter into a data warehouse, they no longer needed to always clean the data before collecting it; these analytics teams could focus on ease of use and speed to governed access.With these new workflows and organization structures in place, domain leaders are better able to lead with data: both via self-service BI tools and from frequent collaboration with data analysts, data scientists, and other data specialists.</td><td>Statisticians and IT served information to business users at the inception of a wider analytics adoption; further into maturity, data analysts and scientists built systems where business users could self-serve insights. In a converged architecture, not only is the business user at the center, but their decision making is augmented by automation. Given this arrangement, there is more collaboration, more automation, and greater scale for data-driven insights as a result of the convergence of teams and workstreams. Teams can work cross-functionally and in parallel across different domains iterating the system to their needs with the raw time and human resources needed to create and maintain analytics products such as dashboards and models.</td></tr><tr><td>Processes</td><td>IT professionals spent long periods of time gathering requirements for analytics projects before they could build or deploy solutions. The team meticulously catalogued sources of data used across the organization, from financial or point-of-sale systems to frequently used external datasets. As part of the warehousing process, it was decided which of these data sources to store and how to store them.Once deployed, data passed into the warehouse through an extract-transform-load process (ETL), where the data was copied from these various sources, cleaned and reshaped into the defined structure of the data warehouse, then inserted into production. In other words, data went through rigorous cleaning and preprocessing before use.To reach this data, users needed to write time-consuming ad hoc queries. Alternatively, particular data segments or summaries that were frequently requested by business users could be delivered via scheduled automation to reports, dashboards, and scorecards.</td><td>As opposed to earlier analytics strategies, IT professionals now seek to collect data as is from any possible source of value. This data can be in a variety of formats, so few predefined rules or relationships are established for ingestion. Depending on the data size, data is processed in batch over discrete time periods, or in streams and events near real time. Because data cleaning is the last step, this process is sometimes referred to as extract-load-transform (ELT), as opposed to the ETL of earlier architectures. For data scientists and other technical professionals, faster access to more and more dynamic data better enables the rapid development of training sets of data for machine learning models. The ELT process allows for the construction of machine learning models, where computers are able to improve performance as more data is passed to them.As more data is collected and put into production, the importance of a data governance process typically grows, describing who has authority over data and how that data should be used. Similar approaches are necessary to audit how models are put into production and how they work.</td><td>While perhaps using different means, the ends of older analytics approaches were the same: insights, whether historic or in support of future decisions, using governed data and processes. In the methods for doing so, however, infrastructure tended to bloat, either from fragile data storage jobs or increasingly complex data pipelines.Given the volume, velocity, and variety of data needed for prescriptive analytics, such monolithic, centralized approaches are less than optimal. Using the tools discussed in the next section, a converged architecture offers a more nimble approach for providing the right insights at the right time to users of all technical levels.Such democratization relies on quick deployment and adjustment of data products; optimizing production, for example, requires bringing more machine learning models to production faster and at scale. The practice of ModelOps is used to institute and govern such rapid production. These processes have become a necessity in rapidly changing business conditions; for example, as the COVID-19 pandemic made structural changes to the economy, many models lost their predictive edge in the face of fundamentally different data.</td></tr><tr><td>Tools</td><td>Data warehouses implemented some new technologies relative to the traditional relational database model. Importantly, the data warehouse separated data into fact tables, where measurements were stored, and dimension tables, which contained descriptive attributes. Business users interacted with the data via reporting software to view static data summaries. These tended to rely on overnight batch jobs to update.In a more sophisticated architecture, analysts could take advantage of online analytical processing (OLAP) cubes. Usually relying on a star schema, OLAP let users query the data across dimensions during interactive sessions. For example, they could “slice and dice” or “roll up and drill down” on the data.By this point, end users had some autonomy in how they looked at and acted upon the data. Automated processes to inform business activities through data were also put into place, such as alerts when inventory or sales dropped below some threshold. Basic what-if analyses also helped business users evaluate decisions and plan for the future.That said, given the limited sources of data from the data warehouse, there were limited ways to customize and work with the data. While reporting and basic analytics were automated, end users operated largely without the assistance of models developed by statisticians. Although business intelligence and operations research seek to create value from data, too often these complementary tools were siloed.</td><td>In 2011, James Dixon, then chief technology officer of Pentaho, coined the term data lake as the architecture needed to support the next level of analytics maturity. Dixon argued that because of the inherently rigid structures of data warehouses, getting value from the increasing volume and variety of data associated with Big Data was difficult. A data lake, “a repository of data stored in its natural/raw format,” was a better approach. In particular, this arrangement wasn’t suited to operate or capitalize on the expanding volume and variety of Big Data.The data lake is often powered by cloud computing for the benefits of reliability, redundancy, and scalability. Dominant cloud service providers include Amazon Web Services (AWS), Microsoft Azure, and Google Cloud Platform (GCP). Open source technologies like Hadoop and Spark are used to process and store massive datasets using parallel computing and distributed storage. Because this data is often unstructured, it may be stored in graph, document, or other non-relational databases.With the increasing volume and velocity of data, and the use of data lakes along with data warehouses to enable data-driven decisions, businesses needed better ways to scale and share business intelligence. One such path was through interactive, immersive exploration and visualization of the data, as pioneered with Spotfire. Other paths were through visual reports and dashboards, as used by not just Spotfire, but by Jaspersoft, Power BI, WebFOCUS, and many others. As BI tools matured, self-service capabilities and automation for end users also matured.</td><td>If maintaining legacy analytics is like raising a thoroughbred, then developing converged analytics is like cultivating a school of goldfish. That is, the backend provisioning is no longer served by monolithic systems but rather by composable groups of microservices. This arrangement supports elastic and scalable analytics; composability makes it easier to adapt to changes driven in part by a growing volume and variety of data sources. In previous analytics approaches, the distinction between backward-facing BI and prediction-focused data science was clear. Under convergence, analytics at the edge is possible—automating analytic computations so they can be performed on non-centralized data generated by sensors, switches, and similar. With converged analytics, individuals no longer need to wait for data science teams to provide ad hoc deeper insights. They have all the data-driven insights at their fingertips, assisted by AI to quickly explore and make decisions. This isn’t just the case for back-office analysts: frontline workers can, for example, adjust how they interact with a customer given data retrieved about that customer at the time of that interaction.</td></tr><tr><td>Data</td><td>During this period, data tended to be transactional, or related to sales and purchases. Take a point-of-sales (POS) system, for example. Each time a sale is made, information about what was sold, possibly to whom, is recorded in the POS system. Those records can be compiled into tables and ultimately processed into a data warehouse.Under this process, data is gathered from prespecified sources at prespecified times, such as a nightly POS extract. Not all data made its way to the data warehouse, especially in the earlier days of analytics—either because it was judged unimportant, or because it was not prioritized.</td><td>Contemporary analytics expands the variety of data available and used: both structured tables and unstructured sources like natural language and images are available. On account of stream processing, refreshes of this data are available in minutes or even less. In particular, the data lake can accommodate real-time events such as IoT sensor readings, GPS signals, and online transactions as they happen.</td><td>A primary feature of converged analytics is the blending of historical and real-time data. According to a study by Seagate and International Data Corporation (IDC), 30% of all data will be real time by 2025. In particular, IoT sensor readings, GPS signals, and online transactions as they happen are available for immediate analysis and modeling.</td></tr><tr><td>Agility</td><td>The relatively rigid nature of the data warehouse made changes to the collection and dissemination of data difficult. Subsequently, business agility was limited. Business users could get historic data about the business through static reports (descriptive analytics). Through OLAP cubes, they could possibly even dig into the data to parse out cause and effect (diagnostic analytics). But without more immediate access to broader data, it was difficult to advance to predictive analytics, or the ability to ask: “What is going to happen?”</td><td>This next phase in the evolution of analytics gets data-driven insights into the hands of end users quickly, with technology allowing them to interact with it on a deeper level. Data scientists are able to build machine learning systems that improve with more data. Using drag-and-drop tools, business users can process and analyze data without technical assistance. With cloud, automation, and streaming technologies, organizations have been better able to adapt to and plan for changing circumstances. That said, machine learning works only so long in production before the algorithm struggles to account for changes to the business and needs intervention. While data scientists undertake these predictive challenges, BI professionals and domain experts tend to operate solely in analyzing current or past data. The next generation of analytics architecture will further reflect organizational needs for greater collaboration among data scientists, BI and analytics teams, and business users and consumers of analytics insights.</td><td>Earlier analytics tended to isolate skills and processes: technical versus highly technical roles, data collection versus deployment versus modeling, and so forth. Converged analytics promotes close collaboration between teams to rapidly model, deploy, and act on data. As data operations become decentralized, teams and individuals can rapidly mine and act on the analytics.In particular, the marriage of real-time data with machine learning and AI-infused BI allows any user to magnify their own domain knowledge with data-driven insights. These features square precisely with the definition of business agility as “innovation via collaboration to be able to anticipate challenges and opportunities before they occur.” With the support of converged analytics, any professional can detect and act on both challenges and opportunities at the moment of impact, rather than months later.</td></tr></tbody></table><hr><p>©️2021, RecoHut.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/insight">insight</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/ai/blog/2021/10/01/tools-for-building-recommender-systems">Tools for building recommender systems</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2021-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2021</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/62965911?v=4" alt="Sparsh Agarwal"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/sparsh-ai" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Sparsh Agarwal</span></a></div><small class="avatar__subtitle" itemprop="description">Principal Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-33bd5b09c80a9a5b7fc2800532c89fe6.png" width="1280" height="720"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="recombee---recommendation-as-a-service-api">Recombee - Recommendation as a service API<a class="hash-link" href="#recombee---recommendation-as-a-service-api" title="Direct link to heading">​</a></h2><p>Recombee is a Recommender as a Service with easy integration and Admin UI. It can be used in many domains, for example in media (VoD, news …), e-commerce, job boards, aggregators or classifieds. Basically, it can be used in any domain with a catalog of <strong>items</strong> that can be interacted by <strong>users</strong>. The users can interact with the items in many ways: for example view them, rate them, bookmark them, purchase them, etc. Both items and users can have various properties (metadata) that are also used by the recommendation models.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-1.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-1-15d45c6a9a3b165fda99901c593e6df5.png" width="1241" height="992"></p><p><a href="https://docs.recombee.com/tutorial.html" target="_blank" rel="noopener noreferrer">Here</a> is the official tutorial series to get started. </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="amazon-personalize---self-service-platform-to-build-and-serve-recommenders">Amazon Personalize - Self-service Platform to build and serve recommenders<a class="hash-link" href="#amazon-personalize---self-service-platform-to-build-and-serve-recommenders" title="Direct link to heading">​</a></h2><p>Amazon Personalize is a fully managed machine learning service that goes beyond rigid static rule based recommendation systems and trains, tunes, and deploys custom ML models to deliver highly customized recommendations to customers across industries such as retail and media and entertainment.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-2.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-2-bbb5727247011c52a126ddc2f8de6135.png" width="1232" height="402"></p><p>It covers 6 use-cases:</p><p><img loading="lazy" alt="Popular Use-cases" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-3-da7a1a934acc596135dbe5e304954eb0.png" width="1200" height="565"></p><p>Popular Use-cases</p><p>Following are the hands-on tutorials:</p><ol><li><a href="https://github.com/data-science-on-aws/workshop/tree/937f6e4fed53fcc6c22bfac42c2c18a687317995/oreilly_book/02_usecases/personalize_recommendations" target="_blank" rel="noopener noreferrer">Data Science on AWS Workshop - Personalize Recommendations<strong>p</strong></a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/creating-a-recommendation-engine-using-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/creating-a-recommendation-engine-using-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/omnichannel-personalization-with-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/omnichannel-personalization-with-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/using-a-b-testing-to-measure-the-efficacy-of-recommendations-generated-by-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/using-a-b-testing-to-measure-the-efficacy-of-recommendations-generated-by-amazon-personalize/</a></li></ol><p>Also checkout these resources:</p><ol><li><a href="https://www.youtube.com/playlist?list=PLN7ADELDRRhiQB9QkFiZolioeJZb3wqPE" target="_blank" rel="noopener noreferrer">https://www.youtube.com/playlist?list=PLN7ADELDRRhiQB9QkFiZolioeJZb3wqPE</a></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="azure-personalizer---an-api-based-service-with-reinforcement-learning-capability">Azure Personalizer - An API based service with Reinforcement learning capability<a class="hash-link" href="#azure-personalizer---an-api-based-service-with-reinforcement-learning-capability" title="Direct link to heading">​</a></h2><p>Azure Personalizer is a cloud-based API service that helps developers create rich, personalized experiences for each user of your app. It learns from customer&#x27;s real-time behavior, and uses reinforcement learning to select the best item (action) based on collective behavior and reward scores across all users. Actions are the content items, such as news articles, specific movies, or products. It takes a list of items (e.g. list of drop-down choices) and their context (e.g. Report Name, User Name, Time Zone) as input and returns the ranked list of items for the given context. While doing that, it also allows feedback submission regarding the relevance and efficiency of the ranking results returned by the service. The feedback (reward score) can be automatically calculated and submitted to the service based on the given personalization use case.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-4.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-4-b0966be33ec9922e5f7f503f9d860308.png" width="1624" height="881"></p><p>You can use the Personalizer service to determine what product to suggest to shoppers or to figure out the optimal position for an advertisement. After the content is shown to the user, your application monitors the user&#x27;s reaction and reports a reward score back to the Personalizer service. This ensures continuous improvement of the machine learning model, and Personalizer&#x27;s ability to select the best content item based on the contextual information it receives. </p><p>Following are some of the interesting use cases of Azure Personalizer:</p><ol><li>Blog Recommender [<a href="https://youtu.be/fsn7hTOKXsY?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_&amp;t=1145" target="_blank" rel="noopener noreferrer">Video tutorial</a>, <a href="https://github.com/georgiakalyva/azure-personalizer-service" target="_blank" rel="noopener noreferrer">GitHub</a>]</li><li>Food Personalizer [<a href="https://youtu.be/A-8OfoWySHQ?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_&amp;t=1758" target="_blank" rel="noopener noreferrer">Video tutorial</a>, <a href="https://www.slideshare.net/SetuChokshi/introduction-to-reinforcement-learning-with-azure-personalizer-233272693" target="_blank" rel="noopener noreferrer">Slideshare</a>, <a href="https://pipinstall.me/introduction_to_azure_personalizer/" target="_blank" rel="noopener noreferrer">Code Blog</a>]</li><li>Coffee Personalizer [<a href="https://github.com/Azure-Samples/cognitive-services-personalizer-samples/tree/master/samples/azurenotebook" target="_blank" rel="noopener noreferrer">GitHub</a>, <a href="https://youtu.be/vkbIhX7xhcE?list=PLN7ADELDRRhhHRu1tS3gmdeUfeQkG82k_" target="_blank" rel="noopener noreferrer">Video tutorial</a>]</li><li>News Recommendation</li><li>Movie Recommendation</li><li>Product Recommendation</li><li><strong>Intent clarification &amp; disambiguation</strong>: help your users have a better experience when their intent is not clear by providing an option that is personalized.</li><li><strong>Default suggestions</strong> for menus &amp; options: have the bot suggest the most likely item in a personalized way as a first step, instead of presenting an impersonal menu or list of alternatives.</li><li><strong>Bot traits &amp; tone</strong>: for bots that can vary tone, verbosity, and writing style, consider varying these traits.</li><li><strong>Notification &amp; alert content</strong>: decide what text to use for alerts in order to engage users more.</li><li><strong>Notification &amp; alert timing</strong>: have personalized learning of when to send notifications to users to engage them more.</li><li>Dropdown Options - Different users of an application with manager privileges would see a list of reports that they can run. Before Personalizer was implemented, the list of dozens of reports was displayed in alphabetical order, requiring most of the managers to scroll through the lengthy list to find the report they needed. This created a poor user experience for daily users of the reporting system, making for a good use case for Personalizer. The tooling learned from the user behavior and began to rank frequently run reports on the top of the dropdown list. Frequently run reports would be different for different users, and would change over time for each manager as they get assigned to different projects. This is exactly the situation where Personalizer’s reward score-based learning models come into play.</li><li>Projects in Timesheet - Every employee in the company logs a daily timesheet listing all of the projects the user is assigned to. It also lists other projects, such as overhead. Depending upon the employee project allocations, his or her timesheet table could have few to a couple of dozen active projects listed. Even though the employee is assigned to several projects, particularly at lead and manager levels, they don’t log time in more than 2 to 3 projects for a few weeks to months.<ol><li>Reward Score Calculation</li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="google-recommendation---recommender-service-from-google">Google Recommendation - Recommender Service from Google<a class="hash-link" href="#google-recommendation---recommender-service-from-google" title="Direct link to heading">​</a></h2><p><img src="https://cloudx-bricks-prod-bucket.storage.googleapis.com/6a0d4afb1778e55d54cb7d66382a4b25f8748a50a93f3c3403d2a835aa166f3d.svg" alt="https://cloudx-bricks-prod-bucket.storage.googleapis.com/6a0d4afb1778e55d54cb7d66382a4b25f8748a50a93f3c3403d2a835aa166f3d.svg"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="abacusai---self-service-platform-at-cheaper-price"><a href="http://abacus.ai" target="_blank" rel="noopener noreferrer">Abacus.ai</a> - Self-service Platform at cheaper price<a class="hash-link" href="#abacusai---self-service-platform-at-cheaper-price" title="Direct link to heading">​</a></h2><p>It uses multi-objective, real-time recommendations models and provides 4 use-cases for fasttrack train-&amp;-deploy process - Personalized recommendations, personalized search, related items and real-time feed recommendations.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-5.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-5-c0db5366214db1b5ddba15c3046274a1.png" width="1536" height="728"></p><p>Here is the hands-on video tutorial:</p><p><a href="https://youtu.be/7hTKL73f2yA" target="_blank" rel="noopener noreferrer">https://youtu.be/7hTKL73f2yA</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="nvidia-merlin---toolkit-with-gpu-capabilities">Nvidia Merlin - Toolkit with GPU capabilities<a class="hash-link" href="#nvidia-merlin---toolkit-with-gpu-capabilities" title="Direct link to heading">​</a></h2><p>Merlin empowers data scientists, machine learning engineers, and researchers to build high-performing recommenders at scale. Merlin includes tools that democratize building deep learning recommenders by addressing common ETL, training, and inference challenges. Each stage of the Merlin pipeline is optimized to support hundreds of terabytes of data, all accessible through easy-to-use APIs. With Merlin, better predictions than traditional methods and increased click-through rates are within reach.</p><p><img loading="lazy" alt="End-to-end recommender system architecture. FE: feature engineering; PP: preprocessing; ETL: extract-transform-load." src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-6-bab580822491ea307cdcadbf0494cd58.png" width="625" height="401"></p><p>End-to-end recommender system architecture. FE: feature engineering; PP: preprocessing; ETL: extract-transform-load.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-7.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-7-72ce5f1a35b17b1f258151d077e546d5.png" width="954" height="533"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="tfrs---open-source-recommender-library-built-on-top-of-tensorflow">TFRS - Open-source Recommender library built on top of Tensorflow<a class="hash-link" href="#tfrs---open-source-recommender-library-built-on-top-of-tensorflow" title="Direct link to heading">​</a></h2><p>Built with TensorFlow 2.x, TFRS makes it possible to:</p><ul><li>Build and evaluate flexible <strong><a href="https://research.google/pubs/pub48840/" target="_blank" rel="noopener noreferrer">candidate nomination models</a></strong>;</li><li>Freely incorporate item, user, and context <strong><a href="https://tensorflow.org/recommenders/examples/featurization" target="_blank" rel="noopener noreferrer">information</a></strong> into recommendation models;</li><li>Train <strong><a href="https://tensorflow.org/recommenders/examples/multitask" target="_blank" rel="noopener noreferrer">multi-task models</a></strong> that jointly optimize multiple recommendation objectives;</li><li>Efficiently serve the resulting models using <strong><a href="https://www.tensorflow.org/tfx/guide/serving" target="_blank" rel="noopener noreferrer">TensorFlow Serving</a></strong>.</li></ul><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-8.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-8-933d52e40642395d74e8349dc435d525.png" width="1200" height="675"></p><p>Following is a series of official tutorial notebooks:-</p><p><a href="https://www.tensorflow.org/recommenders/examples/quickstart" target="_blank" rel="noopener noreferrer">TensorFlow Recommenders: Quickstart</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="elliot---an-end-to-end-framework-good-for-recommender-system-experiments">Elliot - An end-to-end framework good for recommender system experiments<a class="hash-link" href="#elliot---an-end-to-end-framework-good-for-recommender-system-experiments" title="Direct link to heading">​</a></h2><p><a href="https://elliot.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">Elliot</a> is a comprehensive recommendation framework that aims to run and reproduce an entire experimental pipeline by processing a simple configuration file. The framework loads, filters, and splits the data considering a vast set of strategies (13 splitting methods and 8 filtering approaches, from temporal training-test splitting to nested K-folds Cross-Validation). Elliot optimizes hyperparameters (51 strategies) for several recommendation algorithms (50), selects the best models, compares them with the baselines providing intra-model statistics, computes metrics (36) spanning from accuracy to beyond-accuracy, bias, and fairness, and conducts statistical analysis (Wilcoxon and Paired t-test). The aim is to provide the researchers with a tool to ease (and make them reproducible) all the experimental evaluation phases, from data reading to results collection.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-9.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-9-ac36100c32df3a360e3d4e338e476986.png" width="1280" height="611"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="recbole---another-framework-good-for-recommender-system-model-experiments">RecBole - Another framework good for recommender system model experiments<a class="hash-link" href="#recbole---another-framework-good-for-recommender-system-model-experiments" title="Direct link to heading">​</a></h2><p>RecBole is developed based on Python and PyTorch for reproducing and developing recommendation algorithms in a unified, comprehensive and efficient framework for research purpose. It can be installed from pip, Conda and source, and easy to use. It includes 65 recommendation algorithms, covering four major categories: General Recommendation, Sequential Recommendation, Context-aware Recommendation, and Knowledge-based Recommendation, which can support the basic research in recommender systems.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-10.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-10-2ff1939da16912cf7721faab10905964.png" width="421" height="120"></p><p>Features:</p><ul><li><strong>General and extensible data structure</strong>We deign general and extensible data structures to unify the formatting and usage of various recommendation datasets.</li><li><strong>Comprehensive benchmark models and datasets</strong>We implement 65 commonly used recommendation algorithms, and provide the formatted copies of 28 recommendation datasets.</li><li><strong>Efficient GPU-accelerated execution</strong>We design many tailored strategies in the GPU environment to enhance the efficiency of our library.</li><li><strong>Extensive and standard evaluation protocols</strong>We support a series of commonly used evaluation protocols or settings for testing and comparing recommendation algorithms.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="microsoft-recommenders---a-powerful-set-of-tools-for-building-high-quality-recommender-system-at-low-cost-highly-recommended">Microsoft Recommenders - A powerful set of tools for building high-quality recommender system at low-cost <em>(highly recommended)</em><a class="hash-link" href="#microsoft-recommenders---a-powerful-set-of-tools-for-building-high-quality-recommender-system-at-low-cost-highly-recommended" title="Direct link to heading">​</a></h2><p>The Microsoft Recommenders repository is an open source collection of python utilities and Jupyter notebooks to help accelerate the process of designing, evaluating, and deploying recommender systems. The repository was initially formed by data scientists at Microsoft to consolidate common tools and best practices developed from working on recommender systems in various industry settings. The goal of the tools and notebooks is to show examples of how to effectively build, compare, and then deploy the best recommender solution for a given scenario. Contributions from the community have brought in new algorithm implementations and code examples covering multiple aspects of working with recommendation algorithms.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-11.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-11-ef09c0b67a5644c593d818afc689edad.png" width="522" height="246"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="surprise---an-open-source-library-with-easy-api-and-powerful-models">Surprise - An open-source library with easy api and powerful models<a class="hash-link" href="#surprise---an-open-source-library-with-easy-api-and-powerful-models" title="Direct link to heading">​</a></h2><p><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">Surprise</a> is a Python <a href="https://www.scipy.org/scikits.html" target="_blank" rel="noopener noreferrer">scikit</a> for building and analyzing recommender systems that deal with explicit rating data.</p><p><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">Surprise</a> <strong>was designed with the following purposes in mind</strong>:</p><ul><li>Give users perfect control over their experiments. To this end, a strong emphasis is laid on <a href="http://surprise.readthedocs.io/en/stable/index.html" target="_blank" rel="noopener noreferrer">documentation</a>, which we have tried to make as clear and precise as possible by pointing out every detail of the algorithms.</li><li>Alleviate the pain of <a href="http://surprise.readthedocs.io/en/stable/getting_started.html#load-a-custom-dataset" target="_blank" rel="noopener noreferrer">Dataset handling</a>. Users can use both <em>built-in</em> datasets (<a href="http://grouplens.org/datasets/movielens/" target="_blank" rel="noopener noreferrer">Movielens</a>, <a href="http://eigentaste.berkeley.edu/dataset/" target="_blank" rel="noopener noreferrer">Jester</a>), and their own <em>custom</em> datasets.</li><li>Provide various ready-to-use <a href="http://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html" target="_blank" rel="noopener noreferrer">prediction algorithms</a> such as <a href="http://surprise.readthedocs.io/en/stable/basic_algorithms.html" target="_blank" rel="noopener noreferrer">baseline algorithms</a>, <a href="http://surprise.readthedocs.io/en/stable/knn_inspired.html" target="_blank" rel="noopener noreferrer">neighborhood methods</a>, matrix factorization-based ( <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVD" target="_blank" rel="noopener noreferrer">SVD</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#unbiased-note" target="_blank" rel="noopener noreferrer">PMF</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.SVDpp" target="_blank" rel="noopener noreferrer">SVD++</a>, <a href="http://surprise.readthedocs.io/en/stable/matrix_factorization.html#surprise.prediction_algorithms.matrix_factorization.NMF" target="_blank" rel="noopener noreferrer">NMF</a>), and <a href="http://surprise.readthedocs.io/en/stable/prediction_algorithms_package.html" target="_blank" rel="noopener noreferrer">many others</a>. Also, various <a href="http://surprise.readthedocs.io/en/stable/similarities.html" target="_blank" rel="noopener noreferrer">similarity measures</a> (cosine, MSD, pearson…) are built-in.</li><li>Make it easy to implement <a href="http://surprise.readthedocs.io/en/stable/building_custom_algo.html" target="_blank" rel="noopener noreferrer">new algorithm ideas</a>.</li><li>Provide tools to <a href="http://surprise.readthedocs.io/en/stable/model_selection.html" target="_blank" rel="noopener noreferrer">evaluate</a>, <a href="http://nbviewer.jupyter.org/github/NicolasHug/Surprise/tree/master/examples/notebooks/KNNBasic_analysis.ipynb/" target="_blank" rel="noopener noreferrer">analyse</a> and <a href="http://nbviewer.jupyter.org/github/NicolasHug/Surprise/blob/master/examples/notebooks/Compare.ipynb" target="_blank" rel="noopener noreferrer">compare</a> the algorithms’ performance. Cross-validation procedures can be run very easily using powerful CV iterators (inspired by <a href="http://scikit-learn.org/" target="_blank" rel="noopener noreferrer">scikit-learn</a> excellent tools), as well as <a href="http://surprise.readthedocs.io/en/stable/getting_started.html#tune-algorithm-parameters-with-gridsearchcv" target="_blank" rel="noopener noreferrer">exhaustive search over a set of parameters</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="spotlight---another-open-source-library">Spotlight - Another open-source library<a class="hash-link" href="#spotlight---another-open-source-library" title="Direct link to heading">​</a></h2><p>Spotlight uses PyTorch to build both deep and shallow recommender models. By providing both a slew of building blocks for loss functions (various pointwise and pairwise ranking losses), representations (shallow factorization representations, deep sequence models), and utilities for fetching (or generating) recommendation datasets, it aims to be a tool for rapid exploration and prototyping of new recommender models.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-12.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-12-5c6173d316d62401ecc35f324f47f7ba.png" width="1020" height="245"></p><p><a href="https://github.com/maciejkula/spotlight/tree/master/examples" target="_blank" rel="noopener noreferrer">Here</a> is a series of hands-on tutorials to get started.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="vowpal-wabbit---library-with-reinforcement-learning-features">Vowpal Wabbit - library with reinforcement learning features<a class="hash-link" href="#vowpal-wabbit---library-with-reinforcement-learning-features" title="Direct link to heading">​</a></h2><p>Vowpal Wabbit is an open source machine learning library, extensively used by industry, and is the first public terascale learning system. It provides fast, scalable machine learning and has unique capabilities such as learning to search, active learning, contextual memory, and extreme multiclass learning. It has a focus on reinforcement learning and provides production ready implementations of Contextual Bandit algorithms. It was developed originally at Yahoo! Research, and currently at Microsoft Research. Vowpal Wabbit sees significant innovation as a research to production vehicle for Microsoft Research.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-13.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-13-5a6e5b81832dd904c8ac5120433e67c3.png" width="369" height="345"></p><p>For most applications, collaborative filtering yields satisfactory results for item recommendations; there are however several issues that arise that might make it difficult to scale up a recommender system.</p><ul><li>The number of features can grow quite large, and given the usual sparsity of consumption datasets, collaborative filtering needs every single feature and datapoint available.</li><li>For new data points, the whole model has to be re-trained</li></ul><p>Vowpal Wabbit’s matrix factorization capabilities can be used to build a recommender that is similar in spirit to collaborative filtering but that avoids the pitfalls that we mentioned before.</p><p>Following are the three introductory hands-on tutorials on building recommender systems with vowpal wabbit:</p><ol><li><a href="https://github.com/microsoft/recommenders/blob/main/examples/02_model_content_based_filtering/vowpal_wabbit_deep_dive.ipynb" target="_blank" rel="noopener noreferrer">Vowpal Wabbit Deep Dive - A Content-based Recommender System using Microsoft Recommender Library</a></li><li><a href="https://vowpalwabbit.org/tutorials/cb_simulation.html" target="_blank" rel="noopener noreferrer">Simulating Content Personalization with Contextual Bandits</a></li><li><a href="https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c" target="_blank" rel="noopener noreferrer">Vowpal Wabbit, The Magic Recommender System!</a></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="dlrm---an-open-source-scalable-model-from-facebooks-ai-team-build-on-top-of-pytorch">DLRM - An open-source scalable model from Facebook&#x27;s AI team, build on top of PyTorch<a class="hash-link" href="#dlrm---an-open-source-scalable-model-from-facebooks-ai-team-build-on-top-of-pytorch" title="Direct link to heading">​</a></h2><p>DLRM advances on other models by combining principles from both collaborative filtering and predictive analytics-based approaches, which enables it to work efficiently with production-scale data and provide state-of-art results.</p><p>In the DLRM model, categorical features are processed using embeddings, while continuous features are processed with a bottom multilayer perceptron (MLP). Then, second-order interactions of different features are computed explicitly. Finally, the results are processed with a top MLP and fed into a sigmoid function in order to give a probability of a click.</p><p><img loading="lazy" alt="/img/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-14.png" src="/ai/assets/images/content-blog-raw-blog-tools-for-building-recommender-systems-untitled-14-66bcd9a8782a87919f0f6dcbb1a18943.png" width="2000" height="1126"></p><p>Following are the hands-on tutorials:</p><ol><li><a href="https://nbviewer.jupyter.org/github/gotorehanahmad/Recommendation-Systems/blob/master/dlrm/dlrm_main.ipynb" target="_blank" rel="noopener noreferrer">https://nbviewer.jupyter.org/github/gotorehanahmad/Recommendation-Systems/blob/master/dlrm/dlrm_main.ipynb</a></li><li><a href="https://nbviewer.jupyter.org/github/mabeckers/dlrm/blob/new_dataset/Train_DLRM_Digix.ipynb" target="_blank" rel="noopener noreferrer">Training Facebook&#x27;s DLRM on the digix dataset</a></li></ol><h2 class="anchor anchorWithStickyNavbar_mojV" id="references">References<a class="hash-link" href="#references" title="Direct link to heading">​</a></h2><ol><li><a href="https://elliot.readthedocs.io/en/latest/" target="_blank" rel="noopener noreferrer">https://elliot.readthedocs.io/en/latest/</a></li><li><a href="https://vowpalwabbit.org/index.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/index.html</a></li><li><a href="https://abacus.ai/user_eng" target="_blank" rel="noopener noreferrer">https://abacus.ai/user_eng</a></li><li><a href="https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/" target="_blank" rel="noopener noreferrer">https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/</a></li><li><a href="https://aws.amazon.com/personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/personalize/</a></li><li><a href="https://github.com/facebookresearch/dlrm" target="_blank" rel="noopener noreferrer">https://github.com/facebookresearch/dlrm</a></li><li><a href="https://www.tensorflow.org/recommenders" target="_blank" rel="noopener noreferrer">https://www.tensorflow.org/recommenders</a></li><li><a href="https://magento.com/products/product-recommendations" target="_blank" rel="noopener noreferrer">https://magento.com/products/product-recommendations</a></li><li><a href="https://cloud.google.com/recommendations" target="_blank" rel="noopener noreferrer">https://cloud.google.com/recommendations</a></li><li><a href="https://www.recombee.com/" target="_blank" rel="noopener noreferrer">https://www.recombee.com/</a></li><li><a href="https://recbole.io/" target="_blank" rel="noopener noreferrer">https://recbole.io/</a></li><li><a href="https://github.com/microsoft/recommenders" target="_blank" rel="noopener noreferrer">https://github.com/microsoft/recommenders</a></li><li><a href="http://surpriselib.com/" target="_blank" rel="noopener noreferrer">http://surpriselib.com/</a></li><li><a href="https://github.com/maciejkula/spotlight" target="_blank" rel="noopener noreferrer">https://github.com/maciejkula/spotlight</a></li><li><a href="https://vowpalwabbit.org/tutorials/contextual_bandits.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/tutorials/contextual_bandits.html</a></li><li><a href="https://github.com/VowpalWabbit/vowpal_wabbit/wiki" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/vowpal_wabbit/wiki</a></li><li><a href="https://vowpalwabbit.org/tutorials/cb_simulation.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/tutorials/cb_simulation.html</a></li><li><a href="https://vowpalwabbit.org/rlos/2021/projects.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/rlos/2021/projects.html</a></li><li><a href="https://vowpalwabbit.org/rlos/2020/projects.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/rlos/2020/projects.html</a></li><li><a href="https://getstream.io/blog/recommendations-activity-streams-vowpal-wabbit/" target="_blank" rel="noopener noreferrer">https://getstream.io/blog/recommendations-activity-streams-vowpal-wabbit/</a></li><li><a href="https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c" target="_blank" rel="noopener noreferrer">https://samuel-guedj.medium.com/vowpal-wabbit-the-magic-58b7f1d8e39c</a></li><li><a href="https://vowpalwabbit.org/neurips2019/" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/neurips2019/</a></li><li><a href="https://github.com/VowpalWabbit/neurips2019" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/neurips2019</a></li><li><a href="https://getstream.io/blog/introduction-contextual-bandits/" target="_blank" rel="noopener noreferrer">https://getstream.io/blog/introduction-contextual-bandits/</a></li><li><a href="https://www.youtube.com/watch?v=CeOcNK1xSSA&amp;t=72s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=CeOcNK1xSSA&amp;t=72s</a></li><li><a href="https://vowpalwabbit.org/blog/rlos-fest-2021.html" target="_blank" rel="noopener noreferrer">https://vowpalwabbit.org/blog/rlos-fest-2021.html</a></li><li><a href="https://github.com/VowpalWabbit/workshop" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/workshop</a></li><li><a href="https://github.com/VowpalWabbit/workshop/tree/master/aiNextCon2019" target="_blank" rel="noopener noreferrer">https://github.com/VowpalWabbit/workshop/tree/master/aiNextCon2019</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-one/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part One. Oct, 2019.</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-two/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part Two. Oct, 2019.</a></li><li><a href="https://www.ais.com/azure-cognitive-services-personalizer-part-three/" target="_blank" rel="noopener noreferrer">Blog post by Nasir Mirza. Azure Cognitive Services Personalizer: Part Three. Dec, 2019.</a></li><li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/personalizer/what-is-personalizer" target="_blank" rel="noopener noreferrer">Microsoft Azure Personalizer Official Documentation. Oct, 2020.</a></li><li><a href="https://personalizationdemo.azurewebsites.net/" target="_blank" rel="noopener noreferrer">Personalizer demo.</a></li><li><a href="https://azure.microsoft.com/en-in/services/cognitive-services/personalizer/#faqs" target="_blank" rel="noopener noreferrer">Official Page.</a></li><li><a href="https://www.linkedin.com/pulse/get-hands-azure-personalizer-api-jake-wang/" target="_blank" rel="noopener noreferrer">Blog Post by Jake Wong. Get hands on with the Azure Personalizer API. Aug, 2019.</a></li><li><a href="https://enefitit.medium.com/we-tested-azure-personalizer-heres-what-you-can-expect-8c5ec074a28e" target="_blank" rel="noopener noreferrer">Medium Post.</a></li><li><a href="https://www.valoremreply.com/post/azure-personalizer/" target="_blank" rel="noopener noreferrer">Blog Post.</a></li><li><a href="https://github.com/Azure-Samples/cognitive-services-personalizer-samples" target="_blank" rel="noopener noreferrer">Git Repo.</a></li><li><a href="https://youtu.be/7hTKL73f2yA" target="_blank" rel="noopener noreferrer">https://youtu.be/7hTKL73f2yA</a></li><li><a href="https://abacus.ai/blog/2020/03/31/deep-learning-based-recommendation-systems/#:~:text=Deep%2DLearning%20Based%20Recommendation%20Systems%20%E2%80%94%20Learning%20AI,-By%20Abacus.AI&amp;text=Deep%20Learning%20(DL)%20has%20had,of%20Recommender%20Systems%20(RS)." target="_blank" rel="noopener noreferrer">Deep-Learning Based Recommendation Systems — Learning AI</a></li><li><a href="https://abacus.ai/blog/2020/12/11/evaluating-deep-learning-models-recommender-systems/" target="_blank" rel="noopener noreferrer">Evaluating Deep Learning Models with Abacus.AI – Recommendation Systems</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/pioneering-personalized-user-experiences-at-stockx-with-amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/pioneering-personalized-user-experiences-at-stockx-with-amazon-personalize/</a></li><li><a href="https://aws.amazon.com/blogs/machine-learning/category/artificial-intelligence/amazon-personalize/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/machine-learning/category/artificial-intelligence/amazon-personalize/</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Build_a_content-recommendation_engine_with_Amazon_Personalize_AIM304-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Build_a_content-recommendation_engine_with_Amazon_Personalize_AIM304-R1.pdf</a></li><li><a href="https://aws.amazon.com/blogs/aws/amazon-personalize-real-time-personalization-and-recommendation-for-everyone/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/blogs/aws/amazon-personalize-real-time-personalization-and-recommendation-for-everyone/</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Accelerate_experimentation_with_personalization_models_AIM424-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Accelerate_experimentation_with_personalization_models_AIM424-R1.pdf</a></li><li><a href="https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Personalized_user_engagement_with_machine_learning_AIM346-R1.pdf" target="_blank" rel="noopener noreferrer">https://d1.awsstatic.com/events/reinvent/2019/REPEAT_1_Personalized_user_engagement_with_machine_learning_AIM346-R1.pdf</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-samples" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-samples</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-automated-retraining" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-automated-retraining</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-ingestion-pipeline" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-ingestion-pipeline</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-monitor" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-monitor</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-data-conversion-pipeline" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-data-conversion-pipeline</a></li><li><a href="https://github.com/james-jory/segment-personalize-workshop" target="_blank" rel="noopener noreferrer">https://github.com/james-jory/segment-personalize-workshop</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-samples/tree/master/next_steps/workshops/POC_in_a_box" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-samples/tree/master/next_steps/workshops/POC_in_a_box</a></li><li><a href="https://github.com/Imagination-Media/aws-personalize-magento2" target="_blank" rel="noopener noreferrer">https://github.com/Imagination-Media/aws-personalize-magento2</a></li><li><a href="https://github.com/awslabs/amazon-personalize-optimizer-using-amazon-pinpoint-events" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/amazon-personalize-optimizer-using-amazon-pinpoint-events</a></li><li><a href="https://github.com/aws-samples/amazon-personalize-with-aws-glue-sample-dataset" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/amazon-personalize-with-aws-glue-sample-dataset</a></li><li><a href="https://github.com/awsdocs/amazon-personalize-developer-guide" target="_blank" rel="noopener noreferrer">https://github.com/awsdocs/amazon-personalize-developer-guide</a></li><li><a href="https://github.com/chrisking/NetflixPersonalize" target="_blank" rel="noopener noreferrer">https://github.com/chrisking/NetflixPersonalize</a></li><li><a href="https://github.com/aws-samples/retail-demo-store" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/retail-demo-store</a></li><li><a href="https://github.com/aws-samples/personalize-data-science-sdk-workflow" target="_blank" rel="noopener noreferrer">https://github.com/aws-samples/personalize-data-science-sdk-workflow</a></li><li><a href="https://github.com/apac-ml-tfc/personalize-poc" target="_blank" rel="noopener noreferrer">https://github.com/apac-ml-tfc/personalize-poc</a></li><li><a href="https://github.com/dalacan/personalize-batch-recommendations" target="_blank" rel="noopener noreferrer">https://github.com/dalacan/personalize-batch-recommendations</a></li><li><a href="https://github.com/harunobukameda/Amazon-Personalize-Handson" target="_blank" rel="noopener noreferrer">https://github.com/harunobukameda/Amazon-Personalize-Handson</a></li><li><a href="https://www.sagemakerworkshop.com/personalize/" target="_blank" rel="noopener noreferrer">https://www.sagemakerworkshop.com/personalize/</a></li><li><a href="https://github.com/lmorri/vodpocinabox" target="_blank" rel="noopener noreferrer">https://github.com/lmorri/vodpocinabox</a></li><li><a href="https://github.com/awslabs/unicornflix" target="_blank" rel="noopener noreferrer">https://github.com/awslabs/unicornflix</a></li><li><a href="https://www.youtube.com/watch?v=r9J3UZmddC4&amp;t=966s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=r9J3UZmddC4&amp;t=966s</a></li><li><a href="https://www.youtube.com/watch?v=kTufCK76Yus&amp;t=1436s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=kTufCK76Yus&amp;t=1436s</a></li><li><a href="https://www.youtube.com/watch?v=hY_XzglTkak&amp;t=66s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=hY_XzglTkak&amp;t=66s</a></li><li><a href="https://business.adobe.com/lv/summit/2020/adobe-sensei-powers-magento-product-recommendations.html" target="_blank" rel="noopener noreferrer">https://business.adobe.com/lv/summit/2020/adobe-sensei-powers-magento-product-recommendations.html</a></li><li><a href="https://magento.com/products/product-recommendations" target="_blank" rel="noopener noreferrer">https://magento.com/products/product-recommendations</a></li><li><a href="https://docs.magento.com/user-guide/marketing/product-recommendations.html" target="_blank" rel="noopener noreferrer">https://docs.magento.com/user-guide/marketing/product-recommendations.html</a></li><li><a href="https://vod.webqem.com/detail/videos/magento-commerce/video/6195503645001/magento-commerce---product-recommendations?autoStart=true&amp;page=1" target="_blank" rel="noopener noreferrer">https://vod.webqem.com/detail/videos/magento-commerce/video/6195503645001/magento-commerce---product-recommendations?autoStart=true&amp;page=1</a></li><li><a href="https://blog.adobe.com/en/publish/2020/11/23/new-ai-capabilities-for-magento-commerce-improve-retail.html#gs.yw6mtq" target="_blank" rel="noopener noreferrer">https://blog.adobe.com/en/publish/2020/11/23/new-ai-capabilities-for-magento-commerce-improve-retail.html#gs.yw6mtq</a></li><li><a href="https://developers.google.com/recommender/docs/reference/rest" target="_blank" rel="noopener noreferrer">https://developers.google.com/recommender/docs/reference/rest</a></li><li><a href="https://www.youtube.com/watch?v=nY5U0uQZRyU&amp;t=6s" target="_blank" rel="noopener noreferrer">https://www.youtube.com/watch?v=nY5U0uQZRyU&amp;t=6s</a></li></ol></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/recsys">recsys</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/ai/blog/tags/tool">tool</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ai/blog"><div class="pagination-nav__label">Newer Entries</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ai/blog/page/3"><div class="pagination-nav__label">Older Entries</div></a></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ai/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/ai/docs/concept-basics">Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/ai/docs/tutorials">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/ai/docs/projects">Projects</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ai/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/sparsh-ai/ai" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://nb.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Jupyter Notebooks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://step.recohut.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Interactive Stories<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Recohut Docs, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/ai/assets/js/runtime~main.ad24f9b7.js"></script>
<script src="/ai/assets/js/main.f665fcd1.js"></script>
</body>
</html>